<script defer src="js/profile.js"></script>
<script defer src="js/alerts.js"></script>
<link rel="stylesheet" href="styles/profile.css">
  <br></br>

<h1 id='hello'>Здравствуйте, {{name}}</h1>
<div class="row" id="nav">
<div class='col-sm-3 col-md-2 col-xs-12'>
  <ul class="nav flex-row">
    <li class="nav-item">
      {{#if admin}}
          {{#if mydata}}
            <a class="btn btn-primary btn-sm" aria-current="page" href="/profile?mydata=1" id="mydata">Мои данные</a>
          {{else}}
            <a class="btn btn-sm" aria-current="page" href="/profile?mydata=1" id="mydata">Мои данные</a>
          {{/if}}
          {{#if allorders}}
          <a class="btn btn-primary btn-sm" aria-current="page" href="/profile?allorders=5" id="allorders">Все заказы</a>
          {{else}}
          <a class="btn btn-sm" aria-current="page" href="/profile?allorders=5" id="allorders">Все заказы</a>
          {{/if}}
      {{else}}

      {{#if mydata}}
      <a class="btn btn-primary btn-sm" aria-current="page" href="/profile?mydata=1" id="mydata">Мои данные</a>
      {{else}}
      <a class="btn btn-sm" aria-current="page" href="/profile?mydata=1" id="mydata">Мои данные</a>
      {{/if}}
    </li>
    <li class="nav-item">
      {{#if myorders}}
      <a class="btn btn-primary btn-sm" href="/profile?myorders=2">Мои заказы</a>
      {{else}}
      <a class="btn btn-sm" href="/profile?myorders=2">Мои заказы</a>
      {{/if}}
    <li class="nav-item">
      {{#if successorder}}
      <a class="btn btn-primary btn-sm" href="/profile?successorder=3">Готовые работы</a>
      {{else}}
      <a class="btn btn-sm" href="/profile?successorder=3">Готовые работы</a>
      {{/if}}
    </li>
    <li class="nav-item">
      {{#if neworder}}
      <a class="btn btn-primary btn-sm" href="/profile?neworder=4">Заказать работу</a>
      {{else}}
      <a class="btn btn-sm" href="/profile?neworder=4">Заказать работу</a>
      {{/if}}
    </li>
    {{/if}}
  </ul>
  </div>
  {{#if mydata}}
<div class='col-sm-9 col-md-10 col-xs-12'>
  <div class="mb-3">
        <label class="form-label">Имя:</label>
        <input type="text" class="form-control" id="userName" value="{{name}}">
      </div>
      <div class="mb-3">
        <label class="form-label">Электронная почта:</label>
        <input type="email" class="form-control" id="userEmail" value="{{email}}">
        <div class="form-text" id="emailSaveValidate">Мы не распространяем персональные данные пользователей</div>
      </div>
      <div class="mb-3">
        <label class="form-label">Телефон:</label>
        <input type="tel" class="form-control" id="userPhone" value="{{phone}}">
        <div class="form-text" id="phoneSvaValidate">Мы не распространяем персональные данные пользователей</div>
      </div>
      <button type="click" class="btn btn-primary" id="save" data-bs-toggle="popover" data-bs-placement="bottom" title="Предупреждение" data-bs-content="Убедитесь в валидности номера телефона или электронной почты">Сохранить изменения</button>
      <button type="click" class="btn btn-danger" id="showModal">Удалить профиль</button>
      <br></br>
      <div class="alert alert-primary invisible" id='submessageSave' role="alert">
      </div>
    <div class="mb-3 row">
    <h3>Изменить пароль:</h3>
     <div class="mb-3">
        <label for="pas" class="form-label">Cтарый пароль:</label>
        <input type="password" class="form-control" id="pas" aria-describedby="usernameHelp">
      </div>
      <div class="mb-3">
        <label for="newPas" class="form-label">Новый пароль:</label>
        <input type="password" class="form-control" id="newPas" aria-describedby="usernameHelp">
      </div>
      <div class="mb-3">
        <label for="newPasRepeat" class="form-label">Повторите новый пароль:</label>
        <input type="password" class="form-control" id="newPasRepeat" aria-describedby="emailHelp">
        <div class="form-text" id="for-new-password">Мы не распространяем персональные данные пользователей</div>
      </div>
      <div class="col-sm-10">
        <button type="button" class="btn btn-primary" id="savePassword" data-bs-toggle="popover" data-bs-placement="right" title="Предупреждение" data-bs-content="Введенные пароли совпадают? Поля не могут оставаться пустыми">Сохранить</button>
      </div>
      <br></br>
        <div class="alert alert-primary invisible" id='submessage2' role="alert">
      </div>
    </div>
  </div>

{{/if}}

{{#if myorders}}
 <div class='col-sm-9 col-md-10 col-xs-12'>
  <div class="mb-3 row">
    <div class='order-container'>
      {{#each myUser.orders}}
      <div class="table-orders" id="{{this.id}}">
       <table class="table">
          <thead>
            <tr>
              <th scope="col">Номер заказа:</th>
              <th scope="col">Дата заказа:</th>
              <th scope="col">Тема:</th>
              <th scope="col">Предмет:</th>
              <th scope="col">Стоимость:</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <th>{{this.number}}</th>
              <td>{{this.createdAt}}</td>
              <td>{{this.topic}}</td>
              <td>{{this.subject}}</td>
              <td>Уточняется</td>
            </tr>
            <tr>
          </tbody>

        <button class="btn btn-primary" id="">Обратная связь</button>
        <button class="btn btn-danger" id="showModalCancel">Отменить заказ</button>

        </table>
      </div>
      {{!-- <span class='button-container'>
        <button class="btn btn-primary" id="">Обратная связь</button>
        <button class="btn btn-danger" id="showModalCancel">Отменить заказ</button>
      </span> --}}
        {{/each}}
    </div>
    </div>
  </div>
{{/if}}

{{#if successorder}}
 <div class='col-sm-9 col-md-10 col-xs-12'>
  <div class="mb-3 row">
    <div class='order-container'>
      <div class="table-orders" id="{{this.id}}">
       <table class="table">
          <thead>
            <tr>
              <th scope="col">Номер заказа:</th>
              <th scope="col">Дата заказа:</th>
              <th scope="col">Тема:</th>
              <th scope="col">Предмет:</th>
              <th scope="col"></th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <th>25</th>
              <td>30.04.2021</td>
              <td>Ревеню-менеджмент</td>
              <td>Управление доходами в гостиницах</td>
            </tr>
            <tr>
          </tbody>

        <button class="btn btn-outline-primary btn-sm" id="download"><a class="nav-link active" href="/files/da63854b99cf90ac21df68a908b9f4d4.txt" download>Скачать</a></button>
        </table>
      </div>
      {{!-- <span class='button-container'>
        <button class="btn btn-primary" id="">Обратная связь</button>
        <button class="btn btn-danger" id="showModalCancel">Отменить заказ</button>
      </span> --}}
    </div>
    </div>
  </div>
{{/if}}


{{#if neworder}}
<div class='col-sm-9 col-md-10 col-xs-12 order-box'>
  <div class="order-form">
    <form method="POST" action="/upload" enctype="multipart/form-data" name="newOrder">
    <div class="top-order-form">
      <div class="row">
        <div class="col-md-6 col-xs-12">
          <div class="row">
            <div class="col-sm-8">
              <label for="inputType" class="label-order">Тип работы</label>
              <select id="inputType" class="form-select" name ="type">
                <option selected="" disabled="disabled">Выберите тип работы</option>
                <option value="Диплом" data-workPrice = '= 10.000 руб'>Диплом</option>
                <option value="Курсовая" data-workPrice = '= 5.000 руб'>Курсовая</option>
                <option value="Реферат" data-workPrice = '= 3.500 руб'>Реферат</option>
              </select>
            </div>
            <div class="col-sm-4">
              <label for="inputPages" class="label-order">Кол-во страниц</label>
              <input class="form-control" id="inputPages" name="pages" type="number" min="1">
            </div>
          </div>
        </div>
        <div class="col-md-6 col-xs-12">
          <div class="row">
            <div class="col-sm-4">
              <label for="inputDeadline" class="label-order">Срок сдачи</label>
              <input type="date" id="inputDeadline" name="deadline" class="form-control" value="09.09.2021">
            </div>
            <div class="col-sm-4">
              <label for="inputSources" class="label-order">Кол-во источников</label>
              <input id="inputSources" name="sources" min="1" class="form-control" type="number">
            </div>
            <div class="col-sm-4">
              <label class="checkbox-order label-order">
                  <input class="default" type="checkbox" id="foreign_sources" name="foreignSources" value="1">
                  <span class="check-label">Иностранные источники</span>
              </label>
            </div>
          </div>
        </div>
      </div>

      <div class="row">
        <div class="col-md-6 col-sm-9 col-xs-12">
            <div class="row">
                <div class="col-sm-4">
                  <label for="inputOriginality" class="label-order">Оригинальность</label>
                  <select id="inputOriginality" class="form-select" name ="originality">
                    <option selected value="Неважно">Неважно</option>
                    <option value="21%-30%">21%-30%</option>
                    <option value="31%-40%">31%-40%</option>
                    <option value="41%-50%">41%-50%</option>
                    <option value="51%-60%">51%-60%</option>
                    <option value="61%-70%">61%-70%</option>
                    <option value="71%-80%">71%-80%</option>
                    <option value="81%-90%">81%-90%</option>
                    <option value="91%-100%">91%-100%</option>
                  </select>
                </div>
                <div class="col-sm-8">
                      <label for="inputPlagiat" class="label-order">Проверка</label>
                      <select id="inputPlagiat" class="form-select" name ="plagiat">
                        <option value="Проверка по eTXT">Проверка по eTXT</option>
                        <option selected value="Проверка по antiplagiat.ru">Проверка по antiplagiat.ru</option>
                        <option value="Антиплагиат ВУЗ">Антиплагиат ВУЗ</option>
                      </select>
                </div>
            </div>
        </div>
        <div class="col-md-6 col-sm-3 col-xs-12 co_provider_wrap">
          <label class="checkbox-order label-order">
            <input type="checkbox" id="plagi_report" name="plagiReport" value="1">
            <span class="check-label">Отчёт о плагиате</span>
          </label>
        </div>
      </div>
      
      <div class="row">
        <div class="col-md-6 col-xs-12">
          <label for="subject" class="label-order">Предмет</label>
          <input class="form-control" id="subject" name="subject" type="text" value="" autocomplete="off">
        </div>
        <div class="col-md-6 col-xs-12">
          <label for="topic "class="label-order">Тема</label>
          <input id="topic" name="topic" class="form-control" type="text" value="" style="">
        </div>
      </div>

      <div class="row">
        <div class="col-md-6 col-xs-12">
          <label for="inputFont" class="label-order">Шрифт</label>
          <select id="inputFont" class="form-select" name ="font">
            <option selected value="14 шрифт, полуторный интервал">14 шрифт, полуторный интервал</option>
            <option value="12 шрифт, полуторный интервал">12 шрифт, полуторный интервал</option>
            <option value="14 шрифт, одинарный интервал">14 шрифт, одинарный интервал</option>
            <option value="12 шрифт, одинарный интервал">12 шрифт, одинарный интервал</option>
          </select>
        </div>
        <div class="col-md-6 col-xs-12">
          <label for="university" class="label-order">Вуз(необязательно)</label>
          <input class="form-control" id="university" name="university" type="text" value="">
        </div>
      </div>


      <div class="row">
        <div class="col-md-6 col-xs-12">
          <label for="inputAuthor" class="label-order">Квалификация автора</label>
          <select id="inputAuthor" class="form-select" name="authorQualifications">
              <option selected value="Лучший доступный автор (стандартная цена)">Лучший доступный автор (стандартная цена)</option>
              <option value="Топ-автор с высокой средней оценкой">Топ-автор с высокой средней оценкой</option>
              <option value="Кандидат наук">Кандидат наук</option>
              <option value="Доктор наук">Доктор наук</option>
          </select>
        </div>
      </div>

      <div class="row">
        <div class="col-md-6 col-xs-12">
          <label for="requirements" class="label-order">Требования(необязательно)</label>
          <textarea id="requirements" name="requirements" class="form-control" cols="30" rows="3"></textarea>
        </div>
      </div>

      <div class="row">
        <div class="col-md-6 col-xs-12">
          <div class="file-choose-block">
            <p style="font-size: 14px">Вы можете прикрепить до 5 файлов размером не более 10Мб</p>
              <div class="file">
                  <input id="inputFile" name="file" type="file">
              </div>
          </div>
        </div>
      </div>
    </div>

      <div class="counter-order-form top-b">
        <div class="row justify-content-center">
          <div class="col-md-6 col-xs-12 d-flex flex-column align-items-center">
            <h2>Расчёт стоимости работы</h2>
            <ul class="calc">
              <li>
                <span>Минимальная стоимость</span>
                <span id="showPrice">= 0 р.</span>
              </li>
            </ul>
          </div>
        </div>
      </div>

      <div class="counter-order-form top-b">
        <div class="row justify-content-center">
          <div class="col-md-6 col-xs-12 m-auto d-flex flex-column align-items-center">
            <div class="total-cost">
              <span class="">Итого</span>
              <span id="showFinalPrice">= 0 р.</span>
            </div>
            <div class="span-cost">
              <span id="totalCost">(Окончательная сумма после ответа менеджера)</span>
            </div>
            <button type="submit" class="btn btn-primary btn-block" id="order-btn">Заказать</button>
          </div>
        </div>
      </div>
    </form>
  </div>
</div>

{{/if}}

{{#if admin}}
  {{#if allorders}}
    <div class='col-sm-9 col-md-10 col-xs-12'>
    <div class="mb-3 row">
      <div class='order-container'>
        {{#each orders}}
        <div class="table-orders" id="{{this.id}}">
        <table class="table">
            <thead>
              <tr>
                <th scope="col">Номер заказа:</th>
                <th scope="col">Заказчик:</th>
                <th scope="col">Дата заказа:</th>
                <th scope="col">Тема:</th>
                <th scope="col">Предмет:</th>
                <th scope="col">Стоимость:</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <th>{{this.number}}</th>
                <th>{{this.username}}</th>
                <td>{{this.createdAt}}</td>
                <td>{{this.topic}}</td>
                <td>{{this.subject}}</td>
                <td>уточняется</td>
              </tr>
              <tr>
            </tbody>

          <button class="btn btn-primary" id="">Выполнен</button>
          <button class="btn btn-danger" id="showModalCancel">Отменить заказ</button>

          </table>
        </div>
        {{!-- <span class='button-container'>
          <button class="btn btn-primary" id="">Обратная связь</button>
          <button class="btn btn-danger" id="showModalCancel">Отменить заказ</button>
        </span> --}}
          {{/each}}
      </div>
      </div>
    </div>
  {{/if}}
{{/if}}

<div class="modal" tabindex="-1" id='myModal'>
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Предупреждение</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <p>Вы уверены, что хотите удалить профиль?</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Закрыть</button>
        <button type="button" class="btn btn-primary"  id="deleteProfile">Продолжить</button>
      </div>
    </div>
  </div>
</div>
<div class="modal" tabindex="-1" id='myModalCancel'>
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Предупреждение</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <p>Вы уверены, что хотите отменить заказ?</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Закрыть</button>
        {{!-- <div id="{{myUser.orders._id}}" --}}
        <button type="button" class="btn btn-primary"  id="cancel">Продолжить</button>
      </div>
    </div>
  </div>
</div>
